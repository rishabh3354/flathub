{
  "name": "libmpv",
  "cleanup": [
    "/include",
    "/lib/pkgconfig"
  ],
  "buildsystem": "simple",
  "build-commands": [
    "python3 waf configure --prefix=${FLATPAK_DEST} --enable-libmpv-shared --disable-cplayer --disable-alsa --disable-manpage-build --disable-debug-build",
    "python3 waf build",
    "python3 waf install"
  ],
  "sources": [
    {
      "type": "archive",
      "url": "https://github.com/mpv-player/mpv/archive/v0.36.0.tar.gz",
      "sha256": "29abc44f8ebee013bb2f9fe14d80b30db19b534c679056e4851ceadf5a5e8bf6"
    },
    {
      "type": "file",
      "url": "https://waf.io/waf-2.0.26",
      "sha256": "dcec3e179f9c33a66544f1b3d7d91f20f6373530510fa6a858cddb6bfdcde14b",
      "dest-filename": "waf"
    }
  ],
  "modules": [
    {
      "name": "libass",
      "cleanup": [
        "/include",
        "/lib/*.la",
        "/lib/pkgconfig"
      ],
      "config-opts": [
        "--disable-static"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/libass/libass/releases/download/0.17.1/libass-0.17.1.tar.gz",
          "sha256": "d653be97198a0543c69111122173c41a99e0b91426f9e17f06a858982c2fb03d"
        }
      ],
      "modules": [
        {
          "name": "fribidi",
          "cleanup": [
            "/bin",
            "/include",
            "/lib/pkgconfig",
            "/lib/*.la",
            "/share/man"
          ],
          "buildsystem": "meson",
          "config-opts": [
            "--buildtype=release",
            "-Ddocs=false"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://github.com/fribidi/fribidi.git",
              "tag": "v1.0.12",
              "commit": "6428d8469e536bcbb6e12c7b79ba6659371c435a"
            }
          ]
        }
      ]
    },
    {
      "name": "ffmpeg",
      "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/share/ffmpeg/examples"
      ],
      "config-opts": [
        "--disable-static",
        "--disable-debug",
        "--disable-doc",
        "--disable-ffplay",
        "--enable-shared",
        "--enable-gnutls",
        "--enable-gpl",
        "--enable-libass",
        "--enable-libfribidi",
        "--enable-libmp3lame",
        "--enable-libpulse",
        "--enable-libtheora",
        "--enable-libvorbis",
        "--enable-libvpx",
        "--enable-libx264",
        "--enable-libx265",
        "--enable-libxvid",
        "--enable-amf",
        "--enable-cuvid",
        "--enable-ffnvcodec",
        "--enable-libaom",
        "--enable-libdav1d",
        "--enable-libfontconfig",
        "--enable-libfreetype",
        "--enable-libopenjpeg",
        "--enable-libopus",
        "--enable-libpulse",
        "--enable-librsvg",
        "--enable-libsvtav1",
        "--enable-libxml2",
        "--enable-libzimg",
        "--enable-nvdec",
        "--enable-nvenc",
        "--enable-opencl",
        "--enable-rpath",
        "--enable-vaapi",
        "--enable-vdpau",
        "--enable-libdrm",
        "--enable-libwebp"
      ],
      "build-options": {
        "prepend-path": "/usr/lib/sdk/llvm19/bin",
        "prepend-ld-library-path": "/usr/lib/sdk/llvm19/lib",
        "arch": {
          "x86_64": {
            "config-opts": [
              "--enable-nvdec",
              "--enable-cuvid",
              "--enable-libvpl"
            ]
          }
        }
      },
      "sources": [
        {
          "type": "archive",
          "url": "https://ffmpeg.org/releases/ffmpeg-6.1.2.tar.xz",
          "sha256": "3b624649725ecdc565c903ca6643d41f33bd49239922e45c9b1442c63dca4e38"
        }
      ],
      "modules": [
        {
          "name": "ffnvcodec",
          "only-arches": [
            "x86_64"
          ],
          "buildsystem": "simple",
          "build-commands": [
            "make",
            "make install PREFIX=${FLATPAK_DEST}"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/FFmpeg/nv-codec-headers/releases/download/n12.1.14.0/nv-codec-headers-12.1.14.0.tar.gz",
              "sha256": "62b30ab37e4e9be0d0c5b37b8fee4b094e38e570984d56e1135a6b6c2c164c9f"
            }
          ]
        },
        {
          "name": "xvid",
          "subdir": "build/generic",
          "sources": [
            {
              "type": "archive",
              "url": "https://downloads.xvid.com/downloads/xvidcore-1.3.7.tar.gz",
              "sha256": "abbdcbd39555691dd1c9b4d08f0a031376a3b211652c0d8b3b8aa9be1303ce2d"
            }
          ]
        },
        {
          "name": "libvpx",
          "config-opts": [
            "--enable-runtime-cpu-detect",
            "--enable-shared",
            "--disable-static",
            "--enable-pic",
            "--disable-install-bins",
            "--disable-install-docs",
            "--disable-install-srcs",
            "--enable-vp8",
            "--enable-postproc",
            "--enable-vp9",
            "--enable-vp9-highbitdepth"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/webmproject/libvpx/archive/refs/tags/v1.13.1.tar.gz",
              "sha256": "00dae80465567272abd077f59355f95ac91d7809a2d3006f9ace2637dd429d14"
            }
          ]
        },
        {
          "name": "x264",
          "config-opts": [
            "--enable-shared",
            "--disable-cli",
            "--disable-lavf",
            "--enable-pic"
          ],
          "build-options": {
            "arch": {
              "aarch64": {
                "cxxflags": "-fPIC",
                "config-opts": [
                  "--disable-lto"
                ]
              },
              "x86_64": {
                "config-opts": [
                  "--disable-asm"
                ]
              }
            }
          },
          "post-install": [
            "ln -srf ${FLATPAK_DEST}/lib/libx264.so.* ${FLATPAK_DEST}/lib/libx264.so"
          ],
          "sources": [
            {
              "type": "git",
              "commit": "1771b556ee45207f8711744ccbd5d42a3949b14c",
              "url": "https://git.videolan.org/git/x264.git"
            }
          ]
        },
        {
          "name": "x265",
          "buildsystem": "simple",
          "build-options": {
            "arch": {
              "aarch64": {
                "cxxflags": "-fPIC"
              }
            }
          },
          "build-commands": [
            "mkdir source/build-8 source/build-10 source/build-12",
            "cd source/build-12 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DMAIN12='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
            "cd source/build-12 && make",
            "cd source/build-10 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
            "cd source/build-10 && make",
            "ln -s ../build-10/libx265.a source/build-8/libx265_main10.a",
            "ln -s ../build-12/libx265.a source/build-8/libx265_main12.a",
            "cd source/build-8 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DENABLE_SHARED='TRUE' -DENABLE_CLI='FALSE' -DENABLE_HDR10_PLUS='TRUE' -DEXTRA_LIB='x265_main10.a;x265_main12.a' -DEXTRA_LINK_FLAGS='-L.' -DLINKED_10BIT='TRUE' -DLINKED_12BIT='TRUE'",
            "cd source/build-8 && make",
            "cd source/build-8 && make install"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://bitbucket.org/multicoreware/x265_git/downloads/x265_3.3.tar.gz",
              "sha256": "c6d744a87eda55560da715f56f878640554ddc06e2d0fcbd822fa330affc22cc"
            }
          ]
        },
        {
          "name": "fdkaac",
          "config-opts": [
            "--disable-static"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/mstorsjo/fdk-aac/archive/v2.0.2.tar.gz",
              "sha256": "7812b4f0cf66acda0d0fe4302545339517e702af7674dd04e5fe22a5ade16a90"
            }
          ]
        },
        {
          "name": "lame",
          "cleanup": [
            "/share/doc"
          ],
          "config-opts": [
            "--enable-shared",
            "--disable-static",
            "--disable-frontend",
            "--enable-nasm"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://downloads.sourceforge.net/lame/lame-3.100.tar.gz",
              "sha256": "ddfe36cab873794038ae2c1210557ad34857a4b6bdc515785d1da9e175b1da1e"
            }
          ]
        },
        {
          "name": "zimg",
          "buildsystem": "autotools",
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/sekrit-twc/zimg/archive/release-3.0.6.tar.gz",
              "sha256": "be89390f13a5c9b2388ce0f44a5e89364a20c1c57ce46d382b1fcc3967057577",
              "x-checker-data": {
                "type": "anitya",
                "project-id": 13685,
                "stable-only": true,
                "url-template": "https://github.com/sekrit-twc/zimg/archive/release-$version.tar.gz"
              }
            }
          ]
        },
        {
          "name": "opencl-headers",
          "buildsystem": "simple",
          "build-commands": [
            "cp -av CL /app/include"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/KhronosGroup/OpenCL-Headers/archive/refs/tags/v2025.07.22.tar.gz",
              "sha256": "98f0a3ea26b4aec051e533cb1750db2998ab8e82eda97269ed6efe66ec94a240",
              "x-checker-data": {
                "type": "anitya",
                "project-id": 223257,
                "stable-only": true,
                "url-template": "https://github.com/KhronosGroup/OpenCL-Headers/archive/refs/tags/v$version.tar.gz"
              }
            }
          ]
        },
        {
          "name": "amf-headers",
          "buildsystem": "simple",
          "build-commands": [
            "cp -av amf/public/include/. /app/include/AMF"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/GPUOpen-LibrariesAndSDKs/AMF/archive/refs/tags/v1.4.36.tar.gz",
              "sha256": "240a42033babc7920e5476506d5ac0c5628f67908833168e746406808d0ef146",
              "x-checker-data": {
                "type": "anitya",
                "project-id": 138182,
                "stable-only": true,
                "url-template": "https://github.com/GPUOpen-LibrariesAndSDKs/AMF/archive/refs/tags/v$version.tar.gz"
              }
            }
          ]
        },
        {
          "name": "nv-codec-headers",
          "cleanup": [
            "*"
          ],
          "no-autogen": true,
          "make-install-args": [
            "PREFIX=/app"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://github.com/FFmpeg/nv-codec-headers.git",
              "tag": "n13.0.19.0",
              "commit": "e844e5b26f46bb77479f063029595293aa8f812d",
              "x-checker-data": {
                "type": "git",
                "tag-pattern": "^n([\\d.]+)$"
              }
            }
          ]
        },
        {
          "name": "svt-av1",
          "buildsystem": "cmake-ninja",
          "build-options": {
            "arch": {
              "x86_64": {
                "config-opts": [
                  "-DENABLE_AVX512=ON"
                ]
              }
            }
          },
          "config-opts": [
            "-DCMAKE_BUILD_TYPE=Release",
            "-DBUILD_SHARED_LIBS=ON",
            "-DBUILD_TESTING=OFF",
            "-DBUILD_APPS=OFF"
          ],
          "builddir": true,
          "sources": [
            {
              "type": "git",
              "url": "https://gitlab.com/AOMediaCodec/SVT-AV1.git",
              "commit": "6e69def4ec283fe0b71195671245c3b768bebdef",
              "tag": "v2.3.0",
              "x-checker-data": {
                "type": "git",
                "tag-pattern": "^v([\\d.]+)$",
                "versions": [
                  {
                    "!=": "v3.0.0"
                  },
                  {
                    "!=": "v3.0.1"
                  },
                  {
                    "!=": "v3.0.2"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "intel-onevpl-runtime",
          "buildsystem": "cmake-ninja",
          "builddir": true,
          "only-arches": [
            "x86_64"
          ],
          "config-opts": [
            "-DCMAKE_BUILD_TYPE=Release",
            "-DBUILD_SAMPLES=OFF",
            "-DBUILD_TESTS=OFF",
            "-DBUILD_TOOLS=OFF",
            "-DCMAKE_C_FLAGS=-fno-var-tracking-assignments",
            "-DCMAKE_CXX_FLAGS=-fno-var-tracking-assignments"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/oneapi-src/oneVPL-intel-gpu/archive/intel-onevpl-24.3.0.tar.gz",
              "sha256": "02b01dd73f7c5a4a46860ec01470b484286709cc13f9333a34a089d7e457295e"
            }
          ]
        },
        {
          "name": "oneapi-libvpl",
          "skip-arches": [
            "aarch64"
          ],
          "buildsystem": "cmake-ninja",
          "builddir": true,
          "config-opts": [
            "-DCMAKE_BUILD_TYPE=Release",
            "-DBUILD_SAMPLES=OFF",
            "-DBUILD_TESTS=OFF",
            "-DBUILD_TOOLS=OFF"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/intel/libvpl/archive/refs/tags/v2023.4.0.tar.gz",
              "sha256": "978398c7bb1665a6ad7a1a15cc57dc0204608e56c88436e376b717320a9e63fd"
            }
          ]
        }
      ]
    }
  ]
}